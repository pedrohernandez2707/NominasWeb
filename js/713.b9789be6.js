"use strict";(globalThis["webpackChunkquasar_project"]=globalThis["webpackChunkquasar_project"]||[]).push([[713],{713:(e,l,a)=>{a.r(l),a.d(l,{default:()=>P});var o=a(9835);const i={class:"row"},n={class:"col-xs-3 col-md-2 q-pa-sm"},t={class:"col-xs-9 col-md-5 q-pa-sm"},s={class:"col-xs-9 col-md-5 q-pa-sm"},r={class:"col-xs-4 col-sm-2 col-md-2 q-pa-sm"},u={class:"col-xs-8 col-sm-10 col-md-3 q-pa-sm"},d={style:{height:"500px"}};function c(e,l,a,c,m,p){const v=(0,o.up)("q-input"),g=(0,o.up)("q-toggle"),b=(0,o.up)("q-btn"),f=(0,o.up)("q-select"),h=(0,o.up)("q-form"),y=(0,o.up)("q-icon"),U=(0,o.up)("q-table"),w=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(w,{padding:""},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{onSubmit:e.onSubmit,class:"q-gutter-md",onReset:e.clear},{default:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o._)("div",n,[(0,o.Wm)(v,{modelValue:e.codigo,"onUpdate:modelValue":l[0]||(l[0]=l=>e.codigo=l),type:"number",label:"Código",disable:""},null,8,["modelValue"])]),(0,o._)("div",t,[(0,o.Wm)(v,{modelValue:e.nombre,"onUpdate:modelValue":l[1]||(l[1]=l=>e.nombre=l),type:"text",label:"Nombre",counter:"",rules:[e=>e.length<=40||"El nombre no puede ser mayor a 40 caracteres"]},null,8,["modelValue","rules"])]),(0,o._)("div",s,[(0,o.Wm)(v,{modelValue:e.apellido,"onUpdate:modelValue":l[2]||(l[2]=l=>e.apellido=l),type:"text",label:"Apellido",counter:"",rules:[e=>e.length<=40||"El apellido no puede ser mayor a 40 caracteres"]},null,8,["modelValue","rules"])]),(0,o._)("div",r,[(0,o.Wm)(g,{modelValue:e.estado,"onUpdate:modelValue":l[3]||(l[3]=l=>e.estado=l),color:"green",label:"Estado","left-label":""},null,8,["modelValue"])]),(0,o._)("div",u,[(0,o.Wm)(v,{modelValue:e.pass,"onUpdate:modelValue":l[4]||(l[4]=l=>e.pass=l),type:"text",label:"Contraseña",counter:"",rules:[e=>e.length<=15||"La contraseña no puede ser mayor a 15 caracteres",e=>e.length>=6||"La contraseña debe ser mayor a 6 caracteres"]},{append:(0,o.w5)((()=>[e.codigo?((0,o.wg)(),(0,o.j4)(b,{key:0,round:"",dense:"",flat:"",icon:"save",onClick:e.cambiarClave},null,8,["onClick"])):(0,o.kq)("",!0)])),_:1},8,["modelValue","rules"])]),(0,o.Wm)(f,{class:"col-xs-12 col-sm-2 q-pa-sm",modelValue:e.rol,"onUpdate:modelValue":l[5]||(l[5]=l=>e.rol=l),options:e.roles,label:"Rol / Permiso",filled:""},null,8,["modelValue","options"]),(0,o.Wm)(v,{class:"q-pa-xs col-sm-4 q-pa-sm",modelValue:e.email,"onUpdate:modelValue":l[6]||(l[6]=l=>e.email=l),type:"email",label:"Email",counter:""},null,8,["modelValue"])]),(0,o._)("div",null,[(0,o.Wm)(b,{label:null===e.codigo?"Guardar":"Actualizar",type:"submit",color:"primary"},null,8,["label"]),(0,o.Wm)(b,{label:"Limpiar",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])])),_:1},8,["onSubmit","onReset"]),(0,o._)("div",d,[(0,o.Wm)(U,{class:"full-height",title:"Usuarios",rows:e.usuarios,columns:e.columns,filter:e.filter,pagination:{rowsPerPage:0},onRowClick:e.selectUsuario},{"top-right":(0,o.w5)((()=>[(0,o.Wm)(v,{for:"pos-buscar-detalles",borderless:"",dense:"",modelValue:e.filter,"onUpdate:modelValue":l[7]||(l[7]=l=>e.filter=l),placeholder:"Buscar Usuarios",clearable:""},{append:(0,o.w5)((()=>[(0,o.Wm)(y,{name:"search"})])),_:1},8,["modelValue"])])),"top-left":(0,o.w5)((()=>[(0,o.Wm)(b,{color:"primary","icon-right":"archive",label:"Export to csv",onClick:e.exportTable,"no-caps":""},null,8,["onClick"])])),_:1},8,["rows","columns","filter","onRowClick"])])])),_:1})}var m=a(6646),p=a(9302),v=a(4136),g=a(8651),b=a(499),f=function(e,l,a,o){function i(e){return e instanceof a?e:new a((function(l){l(e)}))}return new(a||(a=Promise))((function(a,n){function t(e){try{r(o.next(e))}catch(l){n(l)}}function s(e){try{r(o["throw"](e))}catch(l){n(l)}}function r(e){e.done?a(e.value):i(e.value).then(t,s)}r((o=o.apply(e,l||[])).next())}))};const h=[{name:"Codigo",label:"Código",field:"id",align:"center"},{name:"Nombres",label:"Nombres",field:"nombre",align:"center"},{name:"Apellidos",label:"Apellidos",field:"apellido",align:"center"},{name:"Email",label:"Email",field:"email",align:"center"},{name:"Estado",label:"Estado",field:"activo",align:"center"},{name:"Rol",label:"Rol",field:"rol",align:"center"}],y=(0,o.aZ)({name:"UsuariosPage",setup(){const e=(0,p.Z)(),l=(0,b.iH)(null),a=(0,b.iH)(null),o=(0,b.iH)(null),i=(0,b.iH)(null),n=(0,b.iH)(!0),t=(0,b.iH)(""),s=(0,b.iH)(["Administrador","Usuario","Colaborador"]),r=(0,b.iH)("Usuario"),u=(0,b.iH)(""),d=(0,b.iH)([]),c=(e,l,a)=>{let o=void 0!==l?l(e,a):e;return o=void 0===o||null===o?"":String(o),o=o.split('"').join('""'),`"${o}"`},y=()=>{const l=[h.map((e=>c(e.label,void 0,void 0)))].concat(d.value.map((e=>h.map((l=>c("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format,e))).join(",")))).join("\r\n"),a=(0,m.Z)("table-export.csv",l,"text/csv");!0!==a&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},U=()=>f(this,void 0,void 0,(function*(){if(!l.value)return;if(!t.value)return;const a=yield(0,g.pW)("Confirmacion","Esta seguro de cambiar la clave al usuario?",{});a&&(e.loading.show({}),yield v.api.post(v.endPoints.USUARIOS+"/clave",{id:l.value,clave:t.value}).then((e=>{(0,g.dF)("Proceso Correcto")})).catch((e=>{(0,g.L1)(e)})).finally((()=>{e.loading.hide()})))})),w=()=>f(this,void 0,void 0,(function*(){e.loading.show({delay:400}),yield v.api.get(v.endPoints.USUARIOS).then((e=>{d.value=e.data})).catch((e=>{(0,g.L1)(e,{mensaje:e.response.data.mensaje})})).finally((()=>{e.loading.hide()}))})),V=()=>{let s={id:l.value,nombre:a.value,apellido:i.value,contraseña:t.value,email:o.value,activo:n.value,rol:r.value};null===l.value?(e.loading.show(),v.api.post(v.endPoints.USUARIOS,s).then((e=>f(this,void 0,void 0,(function*(){(0,g.dF)("Usuario guardado"),x(),yield w()})))).catch((e=>{(0,g.L1)(e,{mensaje:e.response.data.mensaje})})).finally((()=>{e.loading.hide()}))):(e.loading.show(),v.api.put(v.endPoints.USUARIOS,s).then((e=>f(this,void 0,void 0,(function*(){(0,g.dF)("Usuario guardado"),x(),yield w()})))).catch((e=>{(0,g.L1)(e,{mensaje:e.response.data.mensaje})})).finally((()=>{e.loading.hide()})))},q=(e,t,s)=>{l.value=t.id,a.value=t.nombre,i.value=t.apellido,n.value=t.activo,r.value=t.rol,o.value=t.email},x=()=>{l.value=null,a.value="",i.value="",o.value="",n.value=!0,t.value="",r.value="Usuario"};return{getUsuarios:w,onSubmit:V,selectUsuario:q,clear:x,usuarios:d,columns:h,codigo:l,nombre:a,apellido:i,estado:n,pass:t,roles:s,rol:r,email:o,filter:u,exportTable:y,cambiarClave:U}},created(){this.getUsuarios()}});var U=a(1639),w=a(9885),V=a(8326),q=a(3119),x=a(3175),C=a(4455),W=a(6384),_=a(7580),S=a(2857),j=a(9984),k=a.n(j);const Z=(0,U.Z)(y,[["render",c]]),P=Z;k()(y,"components",{QPage:w.Z,QForm:V.Z,QInput:q.Z,QToggle:x.Z,QBtn:C.Z,QSelect:W.Z,QTable:_.Z,QIcon:S.Z})}}]);