"use strict";(globalThis["webpackChunkquasar_project"]=globalThis["webpackChunkquasar_project"]||[]).push([[529],{8529:(e,l,o)=>{o.r(l),o.d(l,{default:()=>Q});var a=o(9835);const t={class:"row justify-evenly"},i={class:"col-xs-1 col-md-1 q-pa-md"},d={class:"col-xs-3 col-md-2"},n={class:"col-xs-9 col-md-4"},c={class:"col-xs-9 col-md-3"},u={class:"row justify-evenly"},r={class:"col-xs-9 col-md-5"},s={class:"col-xs-3 col-md-2"},m={class:"col-xs-3 col-md-2"},p={style:{height:"500px"}};function g(e,l,o,g,v,b){const f=(0,a.up)("q-input"),h=(0,a.up)("q-select"),P=(0,a.up)("q-btn"),_=(0,a.up)("q-card"),y=(0,a.up)("q-form"),w=(0,a.up)("q-tooltip"),C=(0,a.up)("q-icon"),V=(0,a.up)("q-table"),E=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(E,{padding:""},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{onSubmit:e.onSubmit,class:"q-gutter-md"},{default:(0,a.w5)((()=>[(0,a._)("div",t,[(0,a._)("div",i,[(0,a.Wm)(f,{modelValue:e.periodoActivo,"onUpdate:modelValue":l[0]||(l[0]=l=>e.periodoActivo=l),type:"text",disable:"",label:"Periodo Activo"},null,8,["modelValue"])]),(0,a._)("div",d,[(0,a.Wm)(f,{modelValue:e.codigo,"onUpdate:modelValue":l[1]||(l[1]=l=>e.codigo=l),type:"number",label:"CÃ³digo de Compra",disable:""},null,8,["modelValue"])]),(0,a._)("div",n,[(0,a.Wm)(h,{class:"col-xs-6 col-md-4",modelValue:e.modelEmpleado,"onUpdate:modelValue":l[2]||(l[2]=l=>e.modelEmpleado=l),options:e.optionsEmpleado,label:"Empleado",filled:""},null,8,["modelValue","options"])]),(0,a._)("div",c,[(0,a.Wm)(P,{class:"q-pa-md",label:"Crear Compra",type:"submit",color:"indigo",disable:null!==e.codigo},null,8,["disable"])]),(0,a._)("div",null,[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" Total Q100.00 ")])),_:1})])])])),_:1},8,["onSubmit"]),(0,a.Wm)(y,{onSubmit:e.agregarDetalle,class:"q-gutter-md q-pa-lg"},{default:(0,a.w5)((()=>[(0,a._)("div",u,[(0,a._)("div",r,[(0,a.Wm)(h,{class:"col-xs-12 col-sm-2",modelValue:e.modelProducto,"onUpdate:modelValue":[l[3]||(l[3]=l=>e.modelProducto=l),l[4]||(l[4]=l=>{e.setPrecio(l)})],options:e.optionsProducto,label:"Producto",filled:""},null,8,["modelValue","options"])]),(0,a._)("div",s,[(0,a.Wm)(f,{modelValue:e.precio,"onUpdate:modelValue":l[5]||(l[5]=l=>e.precio=l),type:"text",label:"Precio",disable:""},null,8,["modelValue"])]),(0,a._)("div",m,[(0,a.Wm)(f,{modelValue:e.cantidad,"onUpdate:modelValue":l[6]||(l[6]=l=>e.cantidad=l),type:"number",label:"Cantidad"},null,8,["modelValue"])]),(0,a.Wm)(P,{disable:null==e.codigo,label:"agregar",type:"submit",color:"green"},{default:(0,a.w5)((()=>[null==e.codigo?((0,a.wg)(),(0,a.j4)(w,{key:0,class:""},{default:(0,a.w5)((()=>[(0,a.Uk)("Debe crear una compra primero!")])),_:1})):(0,a.kq)("",!0)])),_:1},8,["disable"])])])),_:1},8,["onSubmit"]),(0,a._)("div",p,[(0,a.Wm)(V,{class:"full-height",title:"Detalles",rows:e.detalles,columns:e.columns,filter:e.filter,pagination:{rowsPerPage:0}},{"top-right":(0,a.w5)((()=>[(0,a.Wm)(f,{for:"pos-buscar-detalles",borderless:"",dense:"",modelValue:e.filter,"onUpdate:modelValue":l[7]||(l[7]=l=>e.filter=l),placeholder:"Buscar Detalles",clearable:""},{append:(0,a.w5)((()=>[(0,a.Wm)(C,{name:"search"})])),_:1},8,["modelValue"])])),_:1},8,["rows","columns","filter"])])])),_:1})}var v=o(9302),b=o(4136),f=o(8651),h=o(499),P=o(8339),_=function(e,l,o,a){function t(e){return e instanceof o?e:new o((function(l){l(e)}))}return new(o||(o=Promise))((function(o,i){function d(e){try{c(a.next(e))}catch(l){i(l)}}function n(e){try{c(a["throw"](e))}catch(l){i(l)}}function c(e){e.done?o(e.value):t(e.value).then(d,n)}c((a=a.apply(e,l||[])).next())}))};const y=[{name:"Compra",label:"Compra",field:"codigo_compra",align:"center"},{name:"Id_Empleado",label:"Id_Empleado",field:"id_empleado",align:"center"},{name:"Nombre",label:"Nombre",field:"nombres",align:"center"},{name:"Id_Producto",label:"Id_Producto",field:"id_producto",align:"center"},{name:"Descripcion",label:"Descripcion",field:"descripcion",align:"center"},{name:"Cantidad",label:"Cantidad",field:"cantidad",align:"center"},{name:"Precio",label:"Precio",field:"precio",align:"center"},{name:"Subtotal",label:"Subtotal",field:"subtotal",align:"center"}],w=(0,a.aZ)({name:"UsuariosPage",setup(){const e=(0,v.Z)(),l=(0,h.iH)(null),o=(0,h.iH)(null),a=(0,h.iH)(0),t=(0,h.iH)(""),i=(0,h.iH)([]),d=(0,h.iH)([]),n=(0,h.iH)(null),c=(0,h.iH)([]),u=(0,h.iH)(null),r=(0,h.iH)(null),s=(0,P.tv)(),m=e=>{o.value=e.precio},p=()=>_(this,void 0,void 0,(function*(){let t={compraId:l.value,productoId:n.value.value,cantidad:a.value,precioUnitario:o.value};e.loading.show(),yield b.api.post(b.endPoints.COMPRA_DET,t).then((e=>_(this,void 0,void 0,(function*(){(0,f.dF)("Compra Creada",{timeout:3e3}),yield g()})))).catch((e=>{(0,f.L1)(e)})).finally((()=>{e.loading.hide()}))})),g=()=>_(this,void 0,void 0,(function*(){if(!l.value)return;let e={compraId:l.value};yield b.api.post(b.endPoints.COMPRA_DET+"/id",e).then((e=>{i.value=e.data,console.log(e.data)})).catch((e=>{(0,f.L1)(e)}))})),w=()=>{if(!u.value)return void(0,f.dF)("Alerta",{subtitulo:"Debe Seleccionar un Empleado!",tipo:"warning"});let o={idEmpleado:u.value.value,idPeriodo:r.value};b.api.post(b.endPoints.COMPRA_ENC,o).then((e=>{(0,f.dF)("Compra Creada",{timeout:3e3}),l.value=e.data.codigo_compra})).catch((e=>{(0,f.L1)(e,{mensaje:e.response.data.mensaje})})).finally((()=>{e.loading.hide()}))},C=()=>_(this,void 0,void 0,(function*(){yield b.api.get(b.endPoints.EMPLEADOS+"/combo").then((e=>{c.value=e.data})).catch((e=>{(0,f.L1)(e)}))})),V=()=>_(this,void 0,void 0,(function*(){yield b.api.get(b.endPoints.PRODUCTOS+"/combo").then((e=>{d.value=e.data})).catch((e=>{(0,f.L1)(e)}))})),E=()=>_(this,void 0,void 0,(function*(){e.loading.show(),yield b.api.get(b.endPoints.PERIODOS+"/activo").then((l=>{if(!l.data[0])return(0,f.x2)("Error",{subtitulo:"No existe un Periodo Activo, debe aperturar el periodo",timeout:1e4}),e.loading.hide(),void s.back();r.value=l.data[0].id})).catch((e=>{(0,f.L1)(e)})).finally((()=>{e.loading.hide()}))}));return{onSubmit:w,detalles:i,columns:y,codigo:l,precio:o,cantidad:a,setPrecio:m,getProductos:V,getEmpleados:C,optionsEmpleado:c,optionsProducto:d,modelProducto:n,modelEmpleado:u,filter:t,agregarDetalle:p,periodoActivo:r,getPeriodoActivo:E}},created(){this.getPeriodoActivo(),this.getEmpleados(),this.getProductos()}});var C=o(1639),V=o(9885),E=o(8326),q=o(3119),x=o(6384),W=o(4455),D=o(4458),S=o(6858),A=o(7580),U=o(2857),Z=o(9984),H=o.n(Z);const I=(0,C.Z)(w,[["render",g]]),Q=I;H()(w,"components",{QPage:V.Z,QForm:E.Z,QInput:q.Z,QSelect:x.Z,QBtn:W.Z,QCard:D.Z,QTooltip:S.Z,QTable:A.Z,QIcon:U.Z})}}]);