"use strict";(globalThis["webpackChunkquasar_project"]=globalThis["webpackChunkquasar_project"]||[]).push([[579],{9579:(e,o,t)=>{t.r(o),t.d(o,{default:()=>E});var a=t(9835),l=t(6970);const i={class:"row"},d={class:"col-xs-4 col-md-4 q-pa-md"},s={class:"col-xs-4 col-md-4 q-pa-md"},n={class:"col-xs-4 col-md- q-pa-md"},r={style:{height:"500px"}};function u(e,o,t,u,c,m){const p=(0,a.up)("q-select"),b=(0,a.up)("q-btn"),f=(0,a.up)("q-form"),g=(0,a.up)("q-td"),h=(0,a.up)("q-item-section"),v=(0,a.up)("q-item"),y=(0,a.up)("q-list"),x=(0,a.up)("q-menu"),w=(0,a.up)("q-icon"),P=(0,a.up)("q-input"),_=(0,a.up)("q-table"),H=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(H,{padding:""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{onSubmit:e.agregarPeriodo,class:"q-gutter-md"},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a._)("div",d,[(0,a.Wm)(p,{modelValue:e.periodo,"onUpdate:modelValue":o[0]||(o[0]=o=>e.periodo=o),options:e.periodos,label:"Periodo",filled:""},null,8,["modelValue","options"])]),(0,a._)("div",s,[(0,a.Wm)(p,{modelValue:e.mes,"onUpdate:modelValue":o[1]||(o[1]=o=>e.mes=o),options:e.meses,label:"Mes",filled:""},null,8,["modelValue","options"])]),(0,a._)("div",n,[(0,a.Wm)(p,{modelValue:e.año,"onUpdate:modelValue":o[2]||(o[2]=o=>e.año=o),options:e.años,label:"Año",filled:""},null,8,["modelValue","options"])])]),(0,a._)("div",null,[(0,a.Wm)(b,{label:"Activar",type:"submit",color:"primary"})])])),_:1},8,["onSubmit"]),(0,a._)("div",r,[(0,a.Wm)(_,{class:"full-height",title:"Historial Periodos",rows:e.periodosRows,columns:e.columns,filter:e.filter,pagination:{rowsPerPage:0}},{"body-cell-Accion":(0,a.w5)((o=>[(0,a.Wm)(g,{props:o,class:"q-pa-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{outline:"",size:"sm",color:"A"==o.row.estado?"primary":"grey",icon:"A"==o.row.estado?"cloud_sync":"print",label:"A"==o.row.estado?"Generar":"Imprimir",onClick:t=>e.generarNomina(o.row)},null,8,["color","icon","label","onClick"])])),_:2},1032,["props"])])),"body-cell-Igss":(0,a.w5)((o=>[(0,a.Wm)(g,{props:o,class:"q-pa-sm"},{default:(0,a.w5)((()=>[2==o.row.periodo?((0,a.wg)(),(0,a.j4)(b,{key:0,outline:"",size:"sm",class:"q-pl-md",color:"A"==o.row.estado?"secondary":"grey",icon:"A"==o.row.estado?"task":"print",label:"A"==o.row.estado?"Generar Igss":"Imprimir Igss",onClick:t=>e.generarNominaIgss(o.row)},null,8,["color","icon","label","onClick"])):((0,a.wg)(),(0,a.j4)(b,{key:1,outline:"",size:"sm",class:"q-pl-md",color:"grey",label:"No disp.",disable:""}))])),_:2},1032,["props"])])),"body-cell":(0,a.w5)((o=>[(0,a.Wm)(g,{props:o},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(o.value),1)])),_:2},1032,["props"]),"A"===o.row.estado?((0,a.wg)(),(0,a.j4)(x,{key:0,"touch-position":"","context-menu":""},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{dense:"",style:{"min-width":"100px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{clickable:"",onClick:t=>e.cerrarPeriodo(o.row.id)},{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Cerrar Periodo")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)):(0,a.kq)("",!0)])),"top-right":(0,a.w5)((()=>[(0,a.Wm)(P,{for:"pos-buscar-detalles",borderless:"",dense:"",modelValue:e.filter,"onUpdate:modelValue":o[3]||(o[3]=o=>e.filter=o),placeholder:"Buscar Empleados",clearable:""},{append:(0,a.w5)((()=>[(0,a.Wm)(w,{name:"search"})])),_:1},8,["modelValue"])])),_:1},8,["rows","columns","filter"])])])),_:1})}var c=t(4376),m=t(9302),p=t(4136),b=t(8651),f=t(499),g=t(1893),h=t(1842),v=t(606),y=t.n(v),x=function(e,o,t,a){function l(e){return e instanceof t?e:new t((function(o){o(e)}))}return new(t||(t=Promise))((function(t,i){function d(e){try{n(a.next(e))}catch(o){i(o)}}function s(e){try{n(a["throw"](e))}catch(o){i(o)}}function n(e){e.done?t(e.value):l(e.value).then(d,s)}n((a=a.apply(e,o||[])).next())}))};g.vfs={},g.jszip=y(),g.DynamicContent={content:{widths:"100%"}},g.fonts={Roboto:{normal:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf",bold:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Medium.ttf",italics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Italic.ttf",bolditalics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-MediumItalic.ttf"}},g.vfs=h.I.vfs;const w=[{name:"Id",label:"Id",field:"id",align:"center"},{name:"Periodo",label:"Periodo",field:"periodo",align:"center"},{name:"Descripcion",label:"Descripcion",field:"descripcion",align:"center"},{name:"Mes",label:"Mes",field:"mes",align:"center"},{name:"Año",label:"Año",field:"año",align:"center"},{name:"Estado",label:"Estado",field:"estado",align:"center"},{name:"Fecha Creacion",label:"Fecha Creacion",field:"fecha",align:"center",format:(e,o)=>`${c.ZP.formatDate(e,"DD-MMMM-YYYY")}`},{name:"Accion",label:"Reporte Nomina",field:"Accion",align:"center"},{name:"Igss",label:"Reporte Igss",field:"Igss",align:"center"}],P=(0,a.aZ)({name:"UsuariosPage",setup(){const e=(0,m.Z)(),o=(0,f.iH)(null),t=(0,f.iH)(null),a=(0,f.iH)([{value:1,label:"Primera Quincena 45%"},{value:2,label:"Segunda Quincena"},{value:3,label:"Bono 14"},{value:4,label:"Aguinaldo"}]),l=(0,f.iH)([{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}]),i=(0,f.iH)(""),d=(0,f.iH)(null),s=(0,f.iH)([{value:2022,label:"2022"},{value:2023,label:"2023"},{value:2024,label:"2024"},{value:2025,label:"2025"},{value:2026,label:"2026"},{value:2027,label:"2027"},{value:2028,label:"2028"}]),n=(0,f.iH)([]),r=()=>x(this,void 0,void 0,(function*(){e.loading.show(),yield p.api.get(p.endPoints.PERIODOS).then((e=>{n.value=e.data})).catch((e=>{(0,b.L1)(e)})).finally((()=>{e.loading.hide()}))})),u=()=>x(this,void 0,void 0,(function*(){if(!o.value||!d.value||!t.value)return void(0,b.x2)("Debe Seleccionar todos los campos");if(7!==o.value.value&&3===t.value.value)return void(0,b.x2)("El periodo de Bono 14 solo puede ser generado en el mes de Julio");if(12!==o.value.value&&4===t.value.value)return void(0,b.x2)("El periodo de Aguinaldo solo puede ser generado en el mes de Diciembre");const a=yield(0,b.pW)("Confirmacion","Desea Agregar el Periodo Activo?",{});if(!a)return;const l={mes:o.value.value,anio:d.value.value,periodo:t.value.value};e.loading.show();yield p.api.post(p.endPoints.PERIODOS,l).then((e=>x(this,void 0,void 0,(function*(){200===e.status&&(yield r(),(0,b.dF)("Agregado Correctamente"))})))).catch((e=>{(0,b.L1)(e)}));e.loading.hide()})),c=o=>x(this,void 0,void 0,(function*(){if("G"===o.estado)return void(yield v(o));const t=yield(0,b.pW)("Confirmacion","Esta seguro de Generar la Nomina?",{});t&&(e.loading.show(),yield p.api.post(p.endPoints.NOMINA,{idPeriodo:o.id}).then((e=>x(this,void 0,void 0,(function*(){200===e.status&&(yield v(o))})))).catch((e=>{(0,b.L1)(e)})),e.loading.hide())})),h=o=>x(this,void 0,void 0,(function*(){if("G"===o.estado)return e.loading.show(),yield y(o),void e.loading.hide();const t=yield(0,b.pW)("Confirmacion","Esta seguro de Generar la Nomina?",{});t&&(e.loading.show(),yield p.api.post(p.endPoints.NOMINA,{idPeriodo:o.id}).then((e=>x(this,void 0,void 0,(function*(){200===e.status&&(yield y(o))})))).catch((e=>{(0,b.L1)(e)})),e.loading.hide())})),v=e=>x(this,void 0,void 0,(function*(){yield p.api.get(p.endPoints.NOMINA,{params:{idPeriodo:e.id}}).then((e=>{if(!e.data)return void(0,b.x2)("No existen Datos para este Periodo");const o=e.data[0],t=o.descripcion,a=`Mes:  ${o.mes}  Año:  ${o.año}`;let l=0;e.data.forEach((e=>{l+=e.total_a_pagar}));const i={documentTitle:"Reporte_Nomina.pdf",pageOrientation:"landscape",pageSize:"Legal",content:[{text:"Reporte de Calculo de Nominas",style:"header"},{text:t,style:"subheader"},{text:a,style:"subheader"},{text:"",style:"subheader"},{text:"",style:"subheader"},{text:"",style:"subheader"},{table:{headerRows:1,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],body:[[{text:"Nombre Empleado",style:"tableHeader"},{text:"Departamento",style:"tableHeader"},{text:"Puesto",style:"tableHeader"},{text:"Salario",style:"tableHeader"},{text:"H Extras",style:"tableHeader"},{text:"H Dobles",style:"tableHeader"},{text:"Comis.",style:"tableHeader"},{text:"Bonif.",style:"tableHeader"},{text:"Bono Ley",style:"tableHeader"},{text:"Compras",style:"tableHeader"},{text:"Igss",style:"tableHeader"},{text:"Total Bonos",style:"tableHeader"},{text:"Total Deduccion",style:"tableHeader"},{text:"Sueldo Liquido",style:"tableHeader"}],...e.data.map((e=>[`${e.empleado_id} - ${e.nombre_empleado}`,e.departamento,e.puesto,`Q. ${e.sueldo.toFixed(2)}`,`Q. ${e.horas_extras.toFixed(2)}`,`Q. ${e.horas_dobles.toFixed(2)}`,`Q. ${e.comisiones.toFixed(2)}`,`Q. ${e.bonificaciones.toFixed(2)}`,`Q. ${e.bono_ley.toFixed(2)}`,`Q. ${e.compras_empleado.toFixed(2)}`,`Q. ${e.igss.toFixed(2)}`,`Q. ${e.total_bonificacion.toFixed(2)}`,`Q. ${e.total_deducciones.toFixed(2)}`,`Q. ${e.total_a_pagar.toFixed(2)}`]))]},layout:"lightHorizontalLines"},{text:"-",style:"total"},{text:`Total General: Q${l}`,style:"total"}],styles:{header:{fontSize:18,bold:!0,alignment:"center"},total:{fontSize:14,bold:!0,alignment:"right"},tableHeader:{bold:!0,fontSize:10,color:"black"},subheader:{fontSize:12,alignment:"center",margin:[0,5,0,0]}},defaultStyle:{fontSize:8}};g.createPdf(i).open()})).catch((e=>{console.log(e),(0,b.L1)(e)}))})),y=e=>x(this,void 0,void 0,(function*(){yield p.api.get(p.endPoints.NOMINA,{params:{idPeriodo:e.id}}).then((e=>{if(!e.data)return void(0,b.x2)("No existen Datos para este Periodo");console.log(e.data);const o=e.data[0],t=(o.descripcion,`Mes:  ${o.mes}  Año:  ${o.año}`);let a=0;e.data.forEach((e=>{a+=e.igss_total}));const l={documentTitle:"Reporte_Nomina_IGGS.pdf",content:[{text:"Reporte de Calculo de IGGS",style:"header"},{text:t,style:"subheader"},{text:"",style:"subheader"},{text:"",style:"subheader"},{text:"",style:"subheader"},{table:{headerRows:1,widths:["auto","auto","auto","auto","auto","auto","auto"],body:[[{text:"Nombre Empleado",style:"tableHeader"},{text:"Departamento",style:"tableHeader"},{text:"Puesto",style:"tableHeader"},{text:"Sueldo",style:"tableHeader"},{text:"Igss Empleado",style:"tableHeader"},{text:"Igss Patrono",style:"tableHeader"},{text:"Total Iggs",style:"tableHeader"}],...e.data.map((e=>[`${e.empleado_id} - ${e.nombre_empleado}`,e.departamento,e.puesto,`Q. ${e.sueldo.toFixed(2)}`,`Q. ${e.igss.toFixed(2)}`,`Q. ${e.igss_patrono.toFixed(2)}`,`Q. ${e.igss_total.toFixed(2)}`]))]}},{text:"-",style:"total"},{text:`Total General: Q${a}`,style:"total"}],styles:{header:{fontSize:18,bold:!0,alignment:"center"},total:{fontSize:14,bold:!0,alignment:"right"},tableHeader:{bold:!0,fontSize:10,color:"black"},subheader:{fontSize:12,alignment:"center",margin:[0,5,0,0]}},defaultStyle:{fontSize:8}};g.createPdf(l).open()})).catch((e=>{console.log(e),(0,b.L1)(e)}))})),P=o=>x(this,void 0,void 0,(function*(){const t=yield(0,b.pW)("Confirmacion","Esta seguro de cerrar el periodo de nominas?",{});t&&(e.loading.show(),yield p.api.post(p.endPoints.PERIODOS+"/cerrar",{periodo:o}).then((e=>x(this,void 0,void 0,(function*(){yield r()})))).catch((e=>{(0,b.L1)(e)})),e.loading.hide())}));return{cerrarPeriodo:P,generarNomina:c,imprimirNomina:v,getPeriodos:r,periodosRows:n,columns:w,meses:l,mes:o,periodo:t,periodos:a,filter:i,año:d,años:s,agregarPeriodo:u,generarNominaIgss:h,imprimirNominaIgss:y}},created(){this.getPeriodos()}});var _=t(1639),H=t(9885),I=t(8326),Q=t(6384),S=t(4455),A=t(7580),N=t(7220),$=t(6362),k=t(3246),q=t(490),R=t(1233),C=t(3119),F=t(2857),D=t(9984),W=t.n(D);const z=(0,_.Z)(P,[["render",u]]),E=z;W()(P,"components",{QPage:H.Z,QForm:I.Z,QSelect:Q.Z,QBtn:S.Z,QTable:A.Z,QTd:N.Z,QMenu:$.Z,QList:k.Z,QItem:q.Z,QItemSection:R.Z,QInput:C.Z,QIcon:F.Z})}}]);